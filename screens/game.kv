#:kivy 2.1.0
#:import PATH_IMAGES tools.path.PATH_IMAGES
#:import PATH_TEXT_FONT tools.path.PATH_TEXT_FONT
#:import TEXT_FONT_COLOR tools.constants.TEXT_FONT_COLOR
#:import partial functools.partial
#:set center_x_faction 0.1
#:set center_x_resource 0.93
#:set horizontal_shift 0.01
#:set upper_y_indic 0.92
#:set vertical_spacing_indic 0.09
#:set label_image_spacing 0.05
#:set image_size_indic 0.08
#:set center_img_height 0.5
#:set center_img_width 0.5
#:set center_img_center_y 0.7
#:set side_img_width 0.3
#:set side_img_height 0.25
#:set side_img_center_x 0.175
#:set side_img_center_y 0.25
#:set text_filling_ratio 0.85
#:set sign_offset 0.035
#:set plus_minus_ratio 1/2.5


<IndicatorLabel@Label>:
    size_hint: 1, 0.5

<GameScreen>:

    # Faction background
    Image:
        id: order_image
        source: PATH_IMAGES + "card_layout.png"
        size_hint: 0.15, vertical_spacing_indic*4.6
        pos_hint: {"center_x": center_x_faction - label_image_spacing*0.45, "center_y": 0.785}
        allow_stretch: True
        keep_ratio:False

    # Plus and minus for factions
    Image:
        id: plus_order
        source: PATH_IMAGES + "plus.png"
        pos_hint: {"center_x": center_x_faction + sign_offset - horizontal_shift, "center_y": upper_y_indic}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: minus_order
        source: PATH_IMAGES + "minus.png"
        pos_hint: {"center_x": center_x_faction + sign_offset - horizontal_shift, "center_y": upper_y_indic}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: plus_military
        source: PATH_IMAGES + "plus.png"
        pos_hint: {"center_x": center_x_faction + sign_offset - horizontal_shift, "center_y": upper_y_indic- vertical_spacing_indic*1}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: minus_military
        source: PATH_IMAGES + "minus.png"
        pos_hint: {"center_x": center_x_faction + sign_offset - horizontal_shift, "center_y": upper_y_indic- vertical_spacing_indic*1}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: plus_civilian
        source: PATH_IMAGES + "plus.png"
        pos_hint: {"center_x": center_x_faction + sign_offset - horizontal_shift, "center_y": upper_y_indic- vertical_spacing_indic*2}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: minus_civilian
        source: PATH_IMAGES + "minus.png"
        pos_hint: {"center_x": center_x_faction + sign_offset - horizontal_shift, "center_y": upper_y_indic- vertical_spacing_indic*2}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: plus_paleo
        source: PATH_IMAGES + "plus.png"
        pos_hint: {"center_x": center_x_faction + sign_offset - horizontal_shift, "center_y": upper_y_indic- vertical_spacing_indic*3}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: minus_paleo
        source: PATH_IMAGES + "minus.png"
        pos_hint: {"center_x": center_x_faction + sign_offset - horizontal_shift, "center_y": upper_y_indic- vertical_spacing_indic*3}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height

    # Faction indicators
    IndicatorLabel:
        id: order_label
        text: root.order_value
        pos_hint: {"center_x": center_x_faction - horizontal_shift, "center_y": upper_y_indic}
        font_size: 20*root.font_ratio
        font_name: root.font_name
        color: TEXT_FONT_COLOR
    Image:
        id: order_image
        source: PATH_IMAGES + "order.png"
        size_hint: None, image_size_indic
        pos_hint: {"center_x": center_x_faction - label_image_spacing - horizontal_shift, "center_y": upper_y_indic}
        allow_stretch: True
        width: self.height
    IndicatorLabel:
        id: military_label
        text: root.military_value
        pos_hint: {"center_x": center_x_faction - horizontal_shift, "center_y": upper_y_indic - vertical_spacing_indic*1}
        font_size: 20*root.font_ratio
        font_name: root.font_name
        color: TEXT_FONT_COLOR
    Image:
        id: military_image
        source: PATH_IMAGES + "military.png"
        size_hint: None, image_size_indic
        pos_hint: {"center_x": center_x_faction - label_image_spacing - horizontal_shift, "center_y": upper_y_indic - vertical_spacing_indic*1}
        allow_stretch: True
        width: self.height
    IndicatorLabel:
        id: civilian_label
        text: root.civilian_value
        pos_hint: {"center_x": center_x_faction - horizontal_shift, "center_y": upper_y_indic - vertical_spacing_indic*2}
        font_size: 20*root.font_ratio
        font_name: root.font_name
        color: TEXT_FONT_COLOR
    Image:
        id: civilian_image
        source: PATH_IMAGES + "civilian.png"
        size_hint: None, image_size_indic
        pos_hint: {"center_x": center_x_faction - label_image_spacing - horizontal_shift, "center_y": upper_y_indic - vertical_spacing_indic*2}
        allow_stretch: True
        width: self.height
    IndicatorLabel:
        id: paleo_label
        text: root.paleo_value
        pos_hint: {"center_x": center_x_faction - horizontal_shift, "center_y": upper_y_indic - vertical_spacing_indic*3}
        font_size: 20*root.font_ratio
        font_name: root.font_name
        color: TEXT_FONT_COLOR
    Image:
        id: paleo_image
        source: PATH_IMAGES + "paleo.png"
        size_hint: None, image_size_indic
        pos_hint: {"center_x": center_x_faction - label_image_spacing - horizontal_shift, "center_y": upper_y_indic - vertical_spacing_indic*3}
        allow_stretch: True
        width: self.height

    # Resources background
    Image:
        id: resources_background
        source: PATH_IMAGES + "card_layout.png"
        size_hint: 0.15, vertical_spacing_indic*3.6
        pos_hint: {"center_x": center_x_resource - label_image_spacing*0.45, "center_y": 0.83}
        allow_stretch: True
        keep_ratio:False
    
    # Plus and minus for resources
    Image:
        id: plus_food
        source: PATH_IMAGES + "plus.png"
        pos_hint: {"center_x": center_x_resource + sign_offset - horizontal_shift, "center_y": upper_y_indic}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: minus_food
        source: PATH_IMAGES + "minus.png"
        pos_hint: {"center_x": center_x_resource + sign_offset - horizontal_shift, "center_y": upper_y_indic}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: plus_weapons
        source: PATH_IMAGES + "plus.png"
        pos_hint: {"center_x": center_x_resource + sign_offset - horizontal_shift, "center_y": upper_y_indic - 1* vertical_spacing_indic}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: minus_weapons
        source: PATH_IMAGES + "minus.png"
        pos_hint: {"center_x": center_x_resource + sign_offset - horizontal_shift, "center_y": upper_y_indic - 1* vertical_spacing_indic}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: plus_tools
        source: PATH_IMAGES + "plus.png"
        pos_hint: {"center_x": center_x_resource + sign_offset - horizontal_shift, "center_y": upper_y_indic - 2* vertical_spacing_indic}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    Image:
        id: minus_tools
        source: PATH_IMAGES + "minus.png"
        pos_hint: {"center_x": center_x_resource + sign_offset - horizontal_shift, "center_y": upper_y_indic - 2* vertical_spacing_indic}
        size_hint: None, image_size_indic * plus_minus_ratio
        allow_stretch: True
        width: self.height
    
    # Resources indicator
    IndicatorLabel:
        id: food_label
        text: root.food_value
        pos_hint: {"center_x": center_x_resource - horizontal_shift, "center_y": upper_y_indic}
        font_size: 20*root.font_ratio
        font_name: root.font_name
        color: TEXT_FONT_COLOR
    Image:
        id: food_image
        source: PATH_IMAGES + "food.png"
        size_hint: None, image_size_indic
        pos_hint: {"center_x": center_x_resource - label_image_spacing - horizontal_shift, "center_y": upper_y_indic}
        allow_stretch: True
        width: self.height
    IndicatorLabel:
        id: weapons_label
        text: root.weapons_value
        pos_hint: {"center_x": center_x_resource - horizontal_shift, "center_y": upper_y_indic -vertical_spacing_indic*1}
        font_size: 20*root.font_ratio
        font_name: root.font_name
        color: TEXT_FONT_COLOR
    Image:
        id: weapons_image
        source: PATH_IMAGES + "weapons.png"
        size_hint: None, image_size_indic
        pos_hint: {"center_x": center_x_resource - label_image_spacing - horizontal_shift, "center_y": upper_y_indic -vertical_spacing_indic*1}
        allow_stretch: True
        width: self.height
    IndicatorLabel:
        id: tools_label
        text: root.tools_value
        pos_hint: {"center_x": center_x_resource - horizontal_shift, "center_y": upper_y_indic -vertical_spacing_indic*2}
        font_size: 20*root.font_ratio
        font_name: root.font_name
        color: TEXT_FONT_COLOR
    Image:
        id: tools_image
        source: PATH_IMAGES + "tools.png"
        size_hint: None, image_size_indic
        pos_hint: {"center_x": center_x_resource - label_image_spacing - horizontal_shift, "center_y": upper_y_indic -vertical_spacing_indic*2}
        allow_stretch: True
        width: self.height

    # Decision center
    ImageWithText:
        id: decision_center
        source: PATH_IMAGES + "decision_background.png"
        size_hint: center_img_width, center_img_height
        pos_hint: {"center_x": 0.5, "center_y": center_img_center_y}
        allow_stretch: True
        keep_ratio:False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR
    
    # Decision left
    ImageWithTextButton:
        id: decision_no
        source: PATH_IMAGES + "decision_choice_background.png"
        size_hint: side_img_width, side_img_height
        pos_hint: {"center_x": side_img_center_x, "center_y":side_img_center_y}
        allow_stretch: True
        keep_ratio: False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR
        release_function: partial(root.choose_answer, "left")
        text_filling_ratio: text_filling_ratio

    # Decision right
    ImageWithTextButton:
        id: decision_yes
        source: PATH_IMAGES + "decision_choice_background.png"
        size_hint: side_img_width, side_img_height
        pos_hint: {"center_x": 1-side_img_center_x, "center_y":side_img_center_y}
        allow_stretch: True
        keep_ratio: False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR
        release_function: partial(root.choose_answer, "right")
        text_filling_ratio: text_filling_ratio
    
    # Decision guillotine
    ImageWithTextButton:
        id: decision_guillotine
        source: PATH_IMAGES + "guillotine.png"
        size_hint: None, 0.2
        pos_hint: {"center_x": 0.5, "center_y": 0.12}
        allow_stretch: True
        keep_ratio: False
        width: self.height
        release_function: partial(root.choose_answer, "down")
    
    # Event background
    ImageWithTextButton:
        id: event
        source: PATH_IMAGES + "event_background.jpg"
        size_hint: center_img_width, center_img_height
        pos_hint: {"center_x": 0.5, "center_y": center_img_center_y}
        allow_stretch: True
        keep_ratio: False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR

    # Decree background
    ImageWithText:
        id: decree_center
        source: PATH_IMAGES + "decree_background.png"
        size_hint: center_img_width, center_img_height
        pos_hint: {"center_x": 0.5, "center_y": center_img_center_y}
        allow_stretch: True
        keep_ratio: False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR
    
    # Decree left
    ImageWithTextButton:
        id: decree_left
        source: PATH_IMAGES + "decree_choice_background.png"
        size_hint: side_img_width, side_img_height
        pos_hint: {"center_x": side_img_center_x, "center_y":side_img_center_y}
        allow_stretch: True
        keep_ratio: False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR
        release_function: partial(root.choose_answer, "left")
    
    # Decree right
    ImageWithTextButton:
        id: decree_right
        source: PATH_IMAGES + "decree_choice_background.png"
        size_hint: side_img_width, side_img_height
        pos_hint: {"center_x": 1-side_img_center_x, "center_y":side_img_center_y}
        allow_stretch: True
        keep_ratio: False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR
        release_function: partial(root.choose_answer, "right")

    # Decree down
    ImageWithTextButton:
        id: decree_down
        source: PATH_IMAGES + "decree_choice_background.png"
        size_hint: side_img_width, side_img_height
        pos_hint: {"center_x": 0.5, "center_y": 0.175}
        allow_stretch: True
        keep_ratio: False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR
        release_function: partial(root.choose_answer, "down")

    # Answer
    ImageWithText:
        id: answer
        source: PATH_IMAGES + "answer_background.jpg"
        size_hint: center_img_width, center_img_height
        pos_hint: {"center_x": 0.5, "center_y": center_img_center_y}
        allow_stretch: True
        keep_ratio: False
        text_font_name: root.font_name
        text_color: TEXT_FONT_COLOR
    
    # Next button
    ImageWithTextButton:
        id: next_button
        source: PATH_IMAGES + "next_button.png"
        size_hint: side_img_width * 0.7, None
        pos_hint: {"center_x": 0.5, "center_y": 0.15}
        allow_stretch: True
        keep_ratio: True
        release_function: root.go_to_next_card

    

    # # Rewind button
    # ImageWithTextButton:
    #     id: rewind_button
    #     source: PATH_IMAGES + "rewind_button.png"
    #     size_hint: 0.1, None
    #     pos_hint: {"center_x": 0.9, "center_y": 0.5}
    #     allow_stretch: True
    #     keep_ratio: True
    #     release_function: root.rewind